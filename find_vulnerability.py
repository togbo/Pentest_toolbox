from pymetasploit3.msfrpc import MsfRpcClient


def find_exploits(service, product, version):
    client = MsfRpcClient('msfpassword')  # Remplacez 'msfpassword' par le mot de passe de votre instance Metasploit
    exploits = []

    # Recherche de modules d'exploitation dans Metasploit
    for module in client.modules.exploits:
        module_info = client.modules.use('exploit', module)
        description = module_info.info['description'].lower()
        if service in description or product in description or version in description:
            exploits.append(module)

    return exploits
