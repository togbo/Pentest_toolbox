import pyfiglet
import subprocess
from colorama import init, Fore, Style

# ANSI color codes
YELLOW = "\033[93m"
NC = "\033[0m"  # No color
# Initialize Colorama
init(autoreset=True)


def show_banner():
    ascii_banner = Fore.BLUE + pyfiglet.figlet_format("PentestBox")
    print(ascii_banner)


def show_menu():
    print("Please choose an option:")
    print("1. Password Analysis")
    print("2. Scan")
    print("3. Exploit Vulnerability")
    print("4. Enumeration")
    print("5. Authentication test")
    print("6. Post exploitation")
    choice = input("Enter your choice (1, 2, 3, 4, 5 or 6): ")
    return choice


def main():
    show_banner()
    choice = show_menu()

    if choice == "1":
        password = input("Enter the password to analyze: ")
        # Call the PasswordChecking script with the password as an argument
        subprocess.run(["python", "PasswordChecking.py", password])

    elif choice == "2":
        target_ip = input("Enter the target IP address: ")
        print("Choose a scan type:")
        print(
            f"{YELLOW}1. Port    : {NC}Shows all open ports {YELLOW}(~15 seconds){NC}")
        print(
            f"{YELLOW}2. Script  : {NC}Runs a script scan on found ports {YELLOW}(~5 minutes){NC}")
        print(f"{YELLOW}3. Full    : {NC}Runs a full range port scan and script scan {YELLOW}(~5-10 minutes){NC}")
        print(
            f"{YELLOW}4. UDP     : {NC}Runs a UDP scan 'requires sudo' {YELLOW}(~5 minutes){NC}")
        print(f"{YELLOW}5. Vulns   : {NC}Runs CVE scan and nmap Vulns scan on all found ports {YELLOW}(~5-15 minutes){NC}")
        print(f"{YELLOW}6. Recon   : {NC}Suggests recon commands and runs them")
        print(
            f"{YELLOW}7. All     : {NC}Runs all the scans {YELLOW}(~20-30 minutes){NC}")
        print(
            f"{YELLOW}8. Web     : {NC}Runs web vulnerability scans using Nikto and SQLMap")
        print(f"{YELLOW}9. Network : {NC}Shows all live hosts in the host's network {YELLOW}(~15 seconds){NC}")
        scan_input = input("Enter the scan type : ")
        scan_type = ""
        if scan_input == "1":
            scan_type = "Port"
        elif scan_input == "2":
            scan_type = "Script"
        elif scan_input == "3":
            scan_type = "Full"
        elif scan_input == "4":
            scan_type = "UDP"
        elif scan_input == "5":
            scan_type = "Vulns"
        elif scan_input == "6":
            scan_type = "Recon"
        elif scan_input == "7":
            scan_type = "all"
        elif scan_input == "8":
            scan_type = "Web"
        elif scan_input == "9":
            scan_type = "network"
        else:
            print("Invalid choice")
            exit()
        # Call the ToolBoxScanner script with the target IP and scan type as arguments
        subprocess.run(["python", "ToolBoxScanner.py",
                       '-H', target_ip, '-t', scan_type])

    elif choice == "3":
        target_ip = input("Enter the target IP address: ")
        # Call the VulnerabilityExploiter script with the target IP as an argument
        subprocess.run(["python", "exploit_vulns.py", target_ip])
    elif choice == "4":
        target = input("Enter the target IP address or URL: ")
        print("Choose an enumeration type:")
        print("1. SMB Shares")
        print("2. Users")
        print("3. Web Directories")
        print("4 = Enum4Linux")
        print("5 = Nmap SMB Enumeration")
        print("6 = LDAP Enumeration")
        print("7 = NetBIOS Scan")
        enum_type = input("Enter the enumeration type (1-7): ")
        subprocess.run(["python", "EnumerationTool.py", target, enum_type])
    elif choice == "5":
        
        # Call the brutforce authentication script.5
        subprocess.run(["python3", "Auth_bruteforce.py"])
    else:
        print("Invalid choice. Please select 1, 2, 3, 4, 5 or 6.")


if __name__ == "__main__":
    main()
